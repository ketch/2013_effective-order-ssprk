\section{Explicit SSP Runge--Kutta methods have effective order at most four}\label{sec:ExRK_barrier}
The classical order of any explicit SSP Runge--Kutta method cannot be greater
than four \cite{Ruuth2002}.
It turns out that the effective order of any explicit SSP Runge--Kutta method 
also cannot be greater than four, although the proof of this result is much more
involved.  
%As Table~\ref{tab:Effective_oc} shows, if we consider an $s$-stage
%RK($s$,$5$,$2$) method, then the coefficients of the main method
%depend on $\beta_2$.
%In particular, the main method must satisfy
%\begin{equation}\label{eq:2nd_order_con}
%    \frac{1}{2}\alpha_3 - \frac{1}{6} = \beta_2 \; \text{ and } \; \frac{1}{4}\alpha_9 - \alpha_{10} + \alpha_{13} = (\beta_2)^2.
%\end{equation}
%For classical order $p \geq 3$ an $s$-stage RK($s$,$5$,$p$) method must satisfy
%\begin{equation}\label{eq:higher_order_con}
%    \frac{1}{4}\alpha_9- \alpha_{10} + \alpha_{13} = 0,
%\end{equation}
%since $\beta_2 = 0$.
%If we require positive weights then the equations \eqref{eq:2nd_order_con},
%$\alpha_4 = \frac{1}{6}$ and $\alpha_1 = 1$ can not be solved simultaneously.
%Also the equation \eqref{eq:higher_order_con} is not compatible with the main method having stage order one.
%This immediately suggests the non existence of fifth-effective order explicit Runge-Kutta methods with positive weights.
%These results are established as follows.
\begin{theorem}\label{cor:no_SSP_5}
    Let $M$ denote a Runge--Kutta method with $\sspcoef>0$.
    Then $M$ has effective order of at most four.
\end{theorem}

In this section we prove an even stronger result,
which is stated in the following lemma.
\begin{lemma}\label{thm:effective_barrier}
	Any Runge--Kutta method with positive weights $\bm{b}>0$
        has effective order at most four.
\end{lemma}

Theorem \ref{cor:no_SSP_5} follows immediately from Lemma \ref{thm:effective_barrier}
and the following well-known result.
\begin{lemma}\label{lem:positive_b}(see \cite[Theorem~4.2]{Kraaijevanger1991},\cite[Lemma 4.2]{Ruuth2002})
	Any irreducible Runge--Kutta method with positive SSP coefficient $\sspcoef>0$
	must have positive weights $\bm{b}>0$.
\end{lemma}

\begin{remark}
	Using Lemma~\ref{thm:effective_barrier} and \cite[Theorem~4.1]{dahlquist2006}, 
  	we may also conclude that any Runge--Kutta method with positive radius of
  	circle contractivity has effective order at most four.
\end{remark}

The proof of Lemma \ref{thm:effective_barrier} makes use of the following 
lemma.
\begin{lemma}\label{Davids_lemma}
	Let $\bm{b},\bm{v} \in \mathbb{R}^{n}$ be given such that
    \begin{subequations}\label{eq:DavidsLemma}
    		\begin{align}
    			b_i & > 0 \mbox{ for all } i, \label{eq:DavidsLemma_a} \\
    			\sum_{i=1}^n b_i & = 1, \label{eq:DavidsLemma_b} \\
    			\sum_{i=1}^n b_i v_i^2 & = \biggl(\sum_{i=1}^n b_i v_i\biggr)^{\!\! 2}. \label{eq:DavidsLemma_c}
    		\end{align}
    	\end{subequations}
    	Then all $v_i$ are equal but at most one; in other words, there exists 
    	$\mu \in \mathbb{R}$ and an integer $k$ such that $v_i = \mu$ for 
    	all $i \ne k$.
\end{lemma}

\begin{proof}
    Let $k$ be an arbitrary integer between $1$ and $n$. 
    Then by collecting terms in powers of $v_k$, \eqref{eq:DavidsLemma_c} 
    can be written
    \begin{equation*}
    		b_k(1-b_k)v_k^2 - 2b_k v_k\sum_{i \neq k}b_i v_i + \sum_{i \neq k}b_i v_i^2 - \biggl(\sum_{i \neq k}b_i v_i\biggr)^{\!\! 2} = 0.  		
	\end{equation*}
	This is a quadratic equation in $v_k$ whose roots are real if and only if
	\begin{equation*}
    		4b_k^2\biggl(\sum_{i \neq k}b_i v_i\biggr)^{\!\! 2} - 4b_k(1-b_k)\Biggl(\sum_{i \neq k}b_i v_i^2 - \biggl(\sum_{i \neq k}b_i v_i\biggr)^{\!\! 2}\Biggr) \geq 0.
	\end{equation*}
	Expanding and canceling terms yields
	\begin{equation*}
    (1-b_k)\sum_{i \neq k}b_i v_i^2 - \biggl(\sum_{i \neq k}b_i v_i\biggr)^{\!\! 2} \leq 0.
	\end{equation*}
	By \eqref{eq:DavidsLemma_b}, $1-b_k = \sum_{j \ne k}b_j$, so we have
	\begin{equation*}
    		\sum_{j \neq k}b_j\sum_{i \neq k}b_i v_i^2 - \sum_{j \neq k}b_j v_j\sum_{i \neq k}b_i v_i \leq 0.
	\end{equation*}
	Noting that the terms corresponding to $i = j$ in the two double sums cancel gives
	%\begin{equation*}
		%    \sum_{j \neq k}b_{j}\sum_{i \neq k,j}b_{i}v_{i}^{2} - \sum_{j \neq k}b_{j}v_{j}\sum_{i \neq j,k}b_{i}v_{i} \leq 0,
	%\end{equation*}
	%or
	\begin{equation*}
    		\sum_{j \neq k}b_j\sum_{i \neq k,j}b_i v_i(v_i - v_j) \leq 0.
	\end{equation*}
	Adding the left hand side to itself, but with $i, j$ reversed, yields
	\begin{equation*}
    		\sum_{j \neq k}b_j\sum_{i \neq k, j}b_i v_i(v_i - v_j) - \sum_{i \neq k}b_i\sum_{j \neq k, i}b_j v_j(v_i - v_j) \leq 0.
	\end{equation*}
	This simplifies to
	\begin{equation*}
    		\sum_{j \neq k}\sum_{i \neq k, j}b_j b_i(v_i - v_j)^2 \leq 0.
	\end{equation*}
	Together with \eqref{eq:DavidsLemma_a}, this implies that $v_i = v_j$ 
	for all $i, j \neq k$.
\end{proof}

\begin{proof}[Proof of Lemma~\ref{thm:effective_barrier}]
\davidtodo{Yiannis, I found a few new errors (mostly grammatical) in this proof.
Please check it again, and let me know if you change anything.}
	Any method of effective order five must have classical order at least two
	(see \cite{Butcher2008_book} or Table~\ref{tab:effective_OCs}).
	%\davidtodo{Cite?}
        %\yiannistodo{We can site Butcher here, yet this is obvious by conditions of the eff. order Table.}
    Thus it is sufficient to show that any method with all non-negative weights
    cannot satisfy the conditions of effective order five and classical order two.

    Let $A,\bm{b},\bm{c}$ denote the coefficients of a Runge--Kutta method with
    effective order at least five, classical order at least two, and positive 
    weights $\bm{b} > 0$.  The effective order five and classical
    order two conditions (see Table~\ref{tab:effective_OCs}) include the following:
    \davidtodo{As we discussed, please make sure that the terminology "five-effective order" etc. does
    not appear anywher in the paper.  I removed it from here.}
    \begin{subequations}\label{eq:theorem_cond}
    		\begin{align}
    			\bm{b}^T\bm{e} & = 1 \label{eq:theorem_cond_a} \\
             	\bm{b}^TA\bm{c} &= \frac{1}{6} \label{eq:theorem_cond_b} \\
            	\frac{1}{2}\bm{b}^T\bm{c}^2 - \frac{1}{6} &= \beta_2 \label{eq:theorem_cond_c} \\
            	\frac{1}{4}\bm{b}^T\bm{c}^4 - \bm{b}^TC^2A\bm{c} + \bm{b}^T(A\bm{c})^2 &= \beta_2^2, \label{eq:theorem_cond_d}
        	\end{align}
	\end{subequations}
	where the powers on vectors are understood component-wise. 
	Define
	\begin{align*} 
		\bm{v} = \frac{1}{2}\bm{c}^2 - A\bm{c}, \\
		\bm{w} = \bm{v}^{2} - \beta_{2}\bm{v}.
	\end{align*}
	Then substituting \eqref{eq:theorem_cond_b} in \eqref{eq:theorem_cond_c} gives
	\begin{equation}\label{eq:btv}
		\beta_2 = \bm{b}^T\bm{v}.
	\end{equation}
	%or by multiplying by $\beta_2$
	%\begin{equation}\label{eq:btbetav}
	%	\beta_2^2 = \bm{b}^T\beta_2\bm{v}.
	%\end{equation}
	Also, \eqref{eq:theorem_cond_d} can be expressed as
	\begin{equation}\label{eq:btv2}
		\beta_2^2 = \bm{b}^T\bm{v}^2.
	\end{equation}
	%and subtracting \eqref{eq:btbetav} gives
        Multiplying \eqref{eq:btv} by $\beta_2$ and subtracting
        from \eqref{eq:btv2} gives
	\begin{equation}\label{eq:btw}
		\bm{b}^T\bm{w} = 0.
	\end{equation}
	First consider the case that $\beta_2 = 0$. 
	Then $\bm{b}^T\bm{v}^2 = 0$, but $\bm{v }\neq 0$ because explicit methods
	cannot have stage order two \cite{Ruuth2002}. This implies that $b_j \leq 0$ 
	for some $j$, which is a contradiction.
        %Hence $\beta_2 \neq 0$.
        So far we have proven the result for classical order $p \ge 3$
        and the proof is similar to the result mentioned in \cite{Ruuth2002}.
        The remainder of our proof deals with classical order $p=2$
        where $\beta_2 \neq 0$.

	By the assumption $\bm{b}>0$, \eqref{eq:btw} implies that either
	$\bm{w} = \bm{0}$, or there is a least one negative and at least one positive 
	element in $\bm{w}$.
	We will show that both possibilities lead to a contradiction.

	\paragraph{Case 1: $\bm{w} = \bm{0}$.}
	By \eqref{eq:btw}, we have $v_i^2 - \beta_2 v_i = 0$ for all $i \in \{1, \dots, s\}$, so 
        for each $i$ either $v_i = 0$ or $v_i = \beta_2$.
	Let the set $I = \{i : v_i = \beta_2\}$.% \subseteq \{1, \dots, s\}$; 
        %then $v_j = 0$ for $j \notin I$.
	Then \eqref{eq:btv} implies 
	\begin{equation*}
		\beta_2 = \sum_{i=1}^s b_i v_i = \sum_{i \in I}b_i\beta_2 = \beta_2\sum_{i \in I}b_i.
	\end{equation*}
	Note that $v_1 = 0$ because the first row of matrix $A$ is identically zero. 
	Thus $\sum_{i\in I}b_i < \sum_{i=1}^s b_i$ and \eqref{eq:theorem_cond_a} 
	implies
	\begin{equation*}
		\beta_2\sum_{i \in I}b_i< \beta_2,
	\end{equation*} 
	which leads to a contradiction.

	\paragraph{Case 2: $\bm{w} \neq \bm{0}$.}
        By \eqref{eq:btw} and the positivity of $\bm{b}$,
	we can choose $i, j \in \{2, \dots, s\}$ such that $w_i < 0 < w_j$.
	We will show that $0 < v_i < \beta_2 < v_j$.

    Since (by \eqref{eq:btw}) $v_i^2 < \beta_2 v_i$, it follows that (using \eqref{eq:btv2})
    \begin{equation}\label{eq:case_2}
    		(\beta_2)^2 = \sum_{j=1}^s b_j v_j^2 < \sum_{j \neq i}^s b_j v_j^2 + \beta_2 b_i v_i.
    	\end{equation}
    	Substituting \eqref{eq:btv} in \eqref{eq:case_2} yields
    	\begin{equation}\label{case_2_b}
    		\beta_2\sum_{j=1}^s b_j v_j < \sum_{j \neq i}^s b_j v_j^2 + \beta_2 b_i v_i
    	\end{equation}
    	or \davidtodo{\eqref{case_2_c} is not equivalent to \eqref{case_2_b}.  Please explain how you obtain \eqref{case_2_c}}.
    	\begin{equation}\label{case_2_c}
            \beta_2\sum_{j \neq i}^s b_j v_j < \sum_{j \neq i}^s b_j v_j^2 < (\beta_2)^2.
    \end{equation}
    Suppose that $v_{i} < 0$. Then\davidtodo{Explain how the next inequality is obtained.}
    \begin{equation*}
    		\beta_2 = \sum_{j=1}^s b_j v_j < \sum_{j \neq i}^s b_j v_j,
    	\end{equation*}
    	hence a contradiction. 
    	Since $v_i \neq 0$, then $v_i > 0$ and in this case $0 < v_i < \beta_2$.
    	
    	Similarly, note that $w_j > 0$ implies $v_j^2 > \beta_2 v_j$. 
    	If $v_j < 0$, then $v_j < \beta_2$ and $v_j < 0 < v_j < \beta_2$. 
    	Since indices $i, j$ are arbitrary chosen, $\beta_2$ is larger than all 
    	components of $\bm{v}$. 
    	This leads to a contradiction since
    	\begin{equation*}
    		\beta_2 = \sum_{k=1}^s b_k v_k < \sum_{k=1}^s b_k\beta_2 < \beta_2.
    	\end{equation*}
    	We have $v_j \neq 0$, therefore $v_j > 0$ which gives $v_j > \beta_2$.
    	
    	In summary, we have shown that
    	\begin{equation}\label{eq:beta_2_condition}
    		v_1 = 0 \quad \text{ and } \quad 0 < v_i < \beta_2 < v_j, \text{ for } i, j \in \{2, \dots, s\}.
    \end{equation}
    Application of Lemma~\ref{Davids_lemma} reveals that all $v_i$ must be equal except for one.
    But \eqref{eq:beta_2_condition} implies that $v_1, v_i$, and $v_j$ are mutually
    distinct, which is a contradiction.
\end{proof}
